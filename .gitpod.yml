# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.

ports:
  - port: 8065
    onOpen: open-browser

tasks:
  - name: Docker
    before: clear
    init: |
      (cd dev && docker-compose pull)
    command: |
      export MM_SERVICESETTINGS_SITEURL=$(gp url 8065)
      (cd dev && docker-compose up)
  - name: Plugin
    before: clear
    init: |
      nvm install v13.14.0
      nvm alias default v13.14.0
      make dist
  - name: Dev
    before: clear
    env:
      MM_SERVICESETTINGS_SITEURL: http://localhost:8065
      MM_SERVICESETTINGS_ENABLEDEVELOPER: true
    init: |
      echo "Installing dependencies! You can check the progress of each in the tabs to the right."
      echo ""
    command: |
      gp await-port 8065
      echo ""
      echo "Server is running at $(gp url 8065)"
      echo ""
      echo "Deploy your plugin with:"
      echo "make deploy"
github:
  prebuilds:
    master: true
    pullRequests: true

vscode:
  extensions:
    - golang.go
